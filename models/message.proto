syntax = "proto3";

/**
Data structures
 */
message Ballot {
    int32 id = 1;
    int32 ballotNum = 2;
}
message PValue {
    Ballot ballot = 1;
    string payload = 2;
}

/**
Official Paxos protocol messages: p1a, p1b, p2a, p2b
 */
message ProposerToAcceptor {
    enum Type {
        p1a = 0;
        p2a = 1;
    }

    Type type = 1;
    Ballot ballot = 2;
    int32 slot = 3;
    string payload = 4;
}

message AcceptorToProposer {
    enum Type {
        p1b = 0;
        p2b = 1;
    }

    Type type = 1;
    int32 acceptorGroupId = 2;
    Ballot ballot = 3;
    int32 slot = 4;
    repeated PValue log = 5; //TODO Acceptors send back whole log in P1B. Could be bad for bandwidth
}

message ProposerReceiver {
    enum Sender {
        proposer = 0;
        batcher = 1;
    }

    Sender sender = 1;
    bool iAmLeader = 2;
    repeated string requests = 3;
}